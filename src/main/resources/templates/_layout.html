<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:sec="http://www.thymeleaf.org/extras/spring-security"
      lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <!-- Pico.css CDN -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@picocss/pico@1/css/pico.min.css">
    <!-- Votre CSS personnalisé si besoin -->
    <!-- <link rel="stylesheet" th:href="@{/css/style.css}"> -->
    <title th:text="${pageTitle ?: 'PayMyBuddy'}">PayMyBuddy</title>
    <style>
        /* Styles additionnels pour l'accessibilité et la présentation */
        .error-message { color: var(--pico-color-red-600); /* Etait red-500, un peu plus de contraste */
                         font-size: 0.9em;
                         margin-top: 0.25rem; /* Ajustement */
                         margin-bottom: 0.75rem; /* Ajustement */
                         border: 1px solid var(--pico-color-red-300);
                         padding: 0.5rem;
                         border-radius: var(--pico-border-radius);
                         background-color: var(--pico-color-red-100);
                       }
        .success-message { color: var(--pico-color-green-700); /* Etait green-500 */
                           border: 1px solid var(--pico-color-green-400); /* Etait green-300 */
                           padding: 0.75rem; /* Ajustement */
                           margin-bottom: 1rem;
                           border-radius: var(--pico-border-radius);
                           background-color: var(--pico-color-green-100);
                         }
        nav ul { padding-left: 0; margin-bottom: 0; }
        nav li { list-style: none; display: inline-block; margin-right: 1rem; }
        nav li:last-child { margin-right: 0; }
        .balance { font-size: 1.5em; font-weight: bold; color: var(--pico-primary); margin-bottom: 1rem;}
        .transactions table { margin-top: 1rem; width: 100%; }
        .transactions th, .transactions td { text-align: left; padding: 0.75rem 0.5rem; border-bottom: 1px solid var(--pico-table-border-color); }
        .transactions th { background-color: var(--pico-table-header-background); font-weight: bold; }
        .transactions tbody tr:nth-child(odd) { background-color: var(--pico-table-row-striping-background); }
        body { padding-bottom: 5rem; display: flex; flex-direction: column; min-height: 100vh; }
        main.container { margin-top: 2rem; flex-grow: 1; }
        footer.container-fluid { background-color: var(--pico-muted-background-color); padding: 1rem 0; text-align: center; margin-top: auto; }
        /* Classe pour cacher visuellement mais garder accessible aux lecteurs d'écran */
        .visually-hidden {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
        /* Surlignage du focus plus visible (Pico le fait déjà bien mais on peut customiser) */
        *:focus-visible {
            outline: 2px solid var(--pico-primary-focus) !important;
            outline-offset: 2px;
        }
    </style>
</head>
<body>
<header class="container-fluid" style="padding: 0.5rem 0; border-bottom: 1px solid var(--pico-form-element-border-color);">
    <nav class="container">
        <ul>
            <li><a th:href="@{/home}" style="text-decoration: none;"><strong>PayMyBuddy</strong></a></li>
        </ul>
        <ul sec:authorize="isAuthenticated()">
            <li><a th:href="@{/home}" role="menuitem">Accueil/Transfert</a></li>
            <li><a th:href="@{/connections}" role="menuitem">Mes Amis</a></li>
            <li><a th:href="@{/profile}" role="menuitem">Profil</a></li>
            <li>
                <form th:action="@{/logout}" method="post" style="display: inline; margin:0;">
                    <input type="hidden" th:name="${_csrf?.parameterName}" th:value="${_csrf?.token}" />
                    <button type="submit" class="secondary outline" style="padding: 0.35rem 0.75rem; margin-bottom:0;">Déconnexion</button>
                </form>
            </li>
        </ul>
        <ul sec:authorize="!isAuthenticated()">
            <li><a th:href="@{/login}" role="menuitem">Connexion</a></li>
            <li><a th:href="@{/register}" role="menuitem">Inscription</a></li>
        </ul>
    </nav>
</header>

<main class="container" id="main-content" role="main">
    <!-- Messages globaux (ceux ajoutés via RedirectAttributes) -->
    <!-- Ces messages doivent avoir un ID unique s'ils sont nombreux pour être référencés par aria-describedby si besoin -->
    <div th:if="${successMessage}" class="success-message" role="alert" th:text="${successMessage}"></div>
    <div th:if="${errorMessage}" class="error-message" role="alert" th:text="${errorMessage}"></div>
    <!-- Autres messages spécifiques (transferSuccess, etc.) sont mieux gérés dans leurs pages respectives
         ou ici avec des IDs uniques s'ils sont génériques. -->

    <!-- Le contenu spécifique de chaque page sera inséré ici -->
    <th:block th:fragment="content"></th:block>
</main>

<footer class="container-fluid">
    <small>© <span th:text="${#dates.year(#dates.createNow())}">2024</span> PayMyBuddy - Tous droits réservés.</small>
</footer>

<!-- Scripts JS si nécessaire -->
<!-- <script th:src="@{/js/main.js}"></script> -->
</body>
</html>